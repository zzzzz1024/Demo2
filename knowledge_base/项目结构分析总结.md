# 项目结构分析总结

## 项目概览

这是一个专注于 SillyTavern 生态系统开发的项目，主要用于角色扮演对话和内容创作工具的开发。

### 项目根目录: `/Users/zq/Datas/25/silly/MY/Demo2`

## 核心技术栈

- **前端框架**: Vue.js + TypeScript
- **构建工具**: Webpack + PostCSS
- **包管理**: pnpm
- **开发环境**: Node.js + ESLint
- **扩展系统**: TavernHelper (酒馆助手)
- **通信协议**: MCP (Model Context Protocol)

## 目录结构分析

### 1. 配置文件层
```
├── package.json          # 项目依赖和脚本配置
├── tsconfig.json         # TypeScript 编译配置
├── webpack.config.ts     # Webpack 构建配置
├── postcss.config.js     # CSS 后处理配置
├── eslint.config.js      # 代码风格检查配置
└── global.d.ts          # 全局类型定义
```

### 2. 类型定义层
```
@types/
├── function/             # 功能模块类型定义
│   ├── audio.d.ts       # 音频处理
│   ├── character.d.ts   # 角色系统
│   ├── chat_message.d.ts # 聊天消息
│   ├── worldbook.d.ts   # 世界书
│   └── ...其他核心类型
└── iframe/              # iframe 通信类型
    ├── script.d.ts      # 脚本接口
    ├── variables.d.ts   # 变量管理
    └── ...通信协议类型
```

### 3. 内容资源层
```
背景管理/
├── 角色卡/              # 角色定义和配置
├── 世界书/              # 背景设定和知识库
│   └── 神秘复苏/        # 具体世界观示例
└── 预设/                # AI 对话预设
    └── kemini/          # 具体预设配置
```

### 4. 模板系统层
```
初始模板/
├── 脚本/                # 脚本开发模板
│   ├── 导入到酒馆中/    # 可直接导入的脚本
│   └── 新建为src文件夹中的文件夹/ # 开发用模板
└── 前端界面/            # 界面开发模板
    ├── 导入到酒馆中/    # 可直接导入的界面
    └── 新建为src文件夹中的文件夹/ # 开发用模板
```

### 5. 知识库层
```
knowledge_base/
├── SillyTavern/         # 核心应用文档
├── JS-Slash-Runner/     # TavernHelper 扩展文档
├── MagVarUpdate/        # 变量更新框架文档
└── 酒馆核心架构/        # 整合的架构分析
```

### 6. 源代码层
```
src/
├── 脚本示例/            # 脚本开发示例
├── 界面示例/            # 界面开发示例
└── 前端1/               # 具体前端项目
```

## 开发工作流

### 1. 构建和监听
```bash
pnpm watch  # 开始监听源代码并编译
```

### 2. MCP 服务
```bash
pnpx @agentdeskai/browser-tools-server@latest  # 启用网页MCP
```

### 3. 开发模式
- **脚本开发**: 在 `src/脚本示例/` 中开发，使用 TypeScript
- **界面开发**: 在 `src/界面示例/` 中开发，使用 Vue.js + TypeScript
- **内容创作**: 在 `背景管理/` 中管理角色卡、世界书和预设

## 技术特色

### 1. 多层架构
- **表现层**: Vue.js 响应式界面
- **逻辑层**: TypeScript 业务逻辑
- **数据层**: TavernHelper 变量管理
- **通信层**: iframe 沙箱和 MCP 协议

### 2. 模块化设计
- 脚本和界面分离开发
- 模板化的项目结构
- 可插拔的扩展系统

### 3. 类型安全
- 完整的 TypeScript 类型定义
- 跨模块的类型检查
- API 接口类型约束

## 应用场景

这个项目适用于：
1. **角色扮演对话**: 创建智能角色和对话系统
2. **内容生成**: 使用 AI 辅助创作故事和设定
3. **交互界面**: 开发自定义的用户界面组件
4. **脚本自动化**: 编写自动化处理脚本
5. **扩展开发**: 为 SillyTavern 开发功能扩展

## 知识库建设

项目已建立完整的知识库，涵盖：
- **调用顺序分析**: 预设、世界书、脚本、正则的执行顺序
- **前端开发指南**: Vue.js 界面开发最佳实践
- **系统架构总览**: SillyTavern 生态系统整体架构
- **API 参考文档**: TavernHelper 完整 API 说明

这些文档为后续开发提供了全面的技术支持和参考指南。
